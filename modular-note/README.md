# 模块化

## 意义

* 一个应用作为一个整体，由很多功能组成，各个功能又有各自实现的代码，如果让人类理解一个应用，人类会倾向于去分析它提供那些功能，这个把应用分不同功能的过程就是模块化思维，可见模块化符合人的思维模式，模块化可以将降低复杂度，说明：模块化思维可以降低对复杂系统的理解成本，从而达到有效理解的目的。
* 如果一个文件代码行数太多，想找到某个功能的实现代码是较为困难的，因为行与行没有明显的区分特征，如果能够将不同的代码以功能区分存放在不同的文件，并用文件名加以区分，就可以将找到特定功能代码这个步骤所花费的时间减少，说明：合理模块化可以降低代码的维护成本
* 如果想一个功能移动到其它地方或项目使用，如果代码没有模块化，就需要找到和复制相关代码，这中间肯会需要去阅读和辨别代码的边界，这是理解成本，在剥离相关的代码的过程，还需要测试一些特性，判断其表现是否与新系统契合，多了一些测试成本，如果直接复制过去使用，就给后续留下了代码维护成本，未来很可能需要再一次理解这块代码。如果选择不直接复制，此时就需要将代码模块化，通过这次模块化可以便于以后复用。总结：对于需要复用的代码，模块化最好越早越好。
* 所有的代码放在一个文件，那么在滚动阅读的时候不可避免的就会看到不相关的代码，每一次滚动都产生了理解、辨别成本，每一次都要去判断当前是什么功能，当前功能代码的边界在哪，这都是理解成本，可能“面条代码”一词就是形容此类场景。前期代码行数不多可能不要紧，但是代码行数一多，滚动就成了必然操作，滚动操作的频率几何上升，在没有办法一目了然的情况下每次阅读代码都需要支付该成本，且和代码行数有关。
* 总结
  * 模块化本身是有一定成本
  * 越晚模块化维护成本越高
  * 阅读、复用或维护代码时，滚动操作成本、理解成本、维护成本是需要重复支付的，且会随着代码行数、复用次数的增加而累计增加
  * 模块化降低代码的理解成本、维护成本、复用成本

## 体现

* 在操作系统中，最小模块化单元通常是文件。
* 在编程语言中，模块化大都以`function`作为最小模块化单元。
* 一些OOP语言，提供对`function`的更高级的管理和分类方式，模块化的手段变得丰富多样
* vue、angular等一类前端框架中通过`Component`组件化思维来组织代码
* angular还提供`ngModule`来管理多个组件、指令

## 何时模块化

* 避免单文件内行数特别多，首要是避免滚动操作成本
* 如果框架提供成熟的模块化功能应该尽早了解使用，如Vue组件、Angular模块
* 对于没有框架，也应该按功能点去拆分文件，且应该在注释描述耦合依赖关系（如果不是显而易见的），便于复用需求时无需额外了解
